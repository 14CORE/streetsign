<div class="row">
<div class="form-group col-md-6">
  <label class="control-label" for="api_key">Application Key (API key)</label>
  <input class="form-control" name="api_key" type="text" value="{{api_key|escape}}"/>
</div>
<div class="form-group col-md-6">
  <label class="control-label" for="api_secret">Application Secret</label>
  <input class="form-control" name="api_secret" type="text" value="{{api_secret|escape}}"/>
</div>
</div>
<hr/>
<div class="row">
<div class="form-group col-md-6">
  <label class="control-label" for="user_key">User Key (Access token)</label>
  <input class="form-control" name="user_key" type="text" value="{{user_key|escape}}"/>
</div>
<div class="form-group col-md-6">
  <label class="control-label" for="user_secret">User Secret (Access token secret)</label>
  <input class="form-control" name="user_secret" type="text" value="{{user_secret|escape}}"/>
</div>
</div>
<a href="https://apps.twitter.com/" target="_blank">Register this app (get some keys)</a>
<hr/>

<div class="form-group">
  <label class="control-label" for="feed_type">Which tweets should I get?</label>
  <select class="form-control" name="feed_type">
    <option value="user_timeline"
        {{ 'selected' if feed_type == 'user_timeline' }}
        >What someone else tweeted</option>
    <option value="home_timeline"
        {{ 'selected' if feed_type == 'home_timeline' or not feed_type }}
        >What's on my "home"</option>
    <option value="mentions"
        {{ 'selected' if feed_type == 'mentions' }}
        >Mentions</option>
    <option value="retweeted_by_me"
        {{ 'selected' if feed_type == 'retweeted_by_me' }}
        >Retweets</option>
    <option value="search"
        {{ 'selected' if feed_type == 'search' }}
        >Search</option>
  </select>
</div>

<div class="form-group {{'hidden' if not feed_type in ('user_timeline','search') }}" id="query_group">
  <label class="control-label" for="query">Search for:</label>
  <input class="form-control" name="query" type="text" value="{{query}}"/>
</div>

<input type="hidden" name="show_avatar" value="true" />

<div class="cf"></div>
<hr/>
<!-- And the advanced stuff... -->

<button type="button" class="btn btn-danger" data-toggle="collapse" data-target="#advanced_rss">Advanced</button> <button id="test_btn_relay" type="button" class="btn btn-success">Test</button>
<div id="advanced_rss" class="collapse">
  <div class="panel panel-danger">
    <div class="panel-body">

 <div class="form-group">
  <label class="control-label" for="url">Current Posts: <i>(automatically updated)</i></label>
    <textarea class="form-control" name="current_posts" >{{current_posts|tojson if current_posts else '[]'}}</textarea>
</div>

 <div class="form-group">
  <label class="control-label" for="url">Allowed HTML Tags: (<i>comma,separated,list</i>)</label>
    <input class="form-control" name="allowed_tags" type="text" value="{{allowed_tags if allowed_tags else default_tags}}"/>
</div>
    </div>
  </div>
</div>

<script>
jLater.push(function($) {
    var do_test = function() { $('#test_btn').click(); };

    $('select[name="feed_type"]').change(function(){
        var val = $('select[name="feed_type"]').val();
        if ((val == 'user_timeline')||(val == 'search')) {
            $('#query_group').removeClass('hidden');
        } else {
            $('#query_group').addClass('hidden');
        }
        })

    $('input[name="url"]').blur(do_test);
    $('input[name="display_template"]').blur(do_test).keyup(do_test);
    $('#test_btn_relay').click(do_test);

    if ($('input[name="url"]').val()) {
        do_test();
    }
});
</script>
<style>
#test_area img.embedded_photo {
    width: 100%;
    height: auto;
}
</style>
